<!--
    Created by: Han Bi
    Form for creating an incident
    Will feature the following fields:
    Ticket number; which is automatically generated
    Incident Priority; choose from low medium and high
    Incident Description; for describing the problem
    Customer Name
    Customer Number
    Customer Email
    Status: New, In-progress, Waiting for customer, Resolved
    Incident Narrative: for describing any action; needs to be timestamped
    ****Concerns****
    Customer Information not linked to anything we have on file
    They should not be given the Choice to choose Status when creating new ticket
    For some Reason, there is no default choice for priority select
-->

<form
  [formGroup]="incidentForm"
  (ngSubmit)="createIncident(); incidentForm.reset()"
>
  <div class="form-group">
    <label for="recordNumber">Ticket Number:</label>
    <input
      type="text"
      formControlName="incidentNumber"
      class="form-control"
      id="recordNumber"
      value="{{ incidentId }}"
      placeholder="{{ incidentId }}"
      readonly
    />

    <label for="incidentPriority">Priority</label>
    <select
      formControlName="incidentPriority"
      class="form-control"
      id="incidentPriority"
      required
    >
      <option *ngFor="let prioSelect of priorities()" value="{{ prioSelect }}">
        {{ prioSelect }}
      </option>
    </select>

    <label for="incidentStatus">Status</label>
    <select
      formControlName="incidentStatus"
      class="form-control"
      id="incidentStatus"
    >
      <option
        *ngFor="let statusSelect of statuses()"
        value="{{ statusSelect }}"
      >
        {{ statusSelect }}
      </option>
    </select>

    <label for="customerName">Customer Name</label>
    <input
      formControlName="customerName"
      type="text"
      class="form-control"
      id="customerName"
      name="customerName"
      placeholder="Customer Name"
      required
    />

    <!--
    <label for="customerLName">Last Name</label>
    <input formControlName="customerLName" type="text" class="form-control" id="customerLName" name="customerLName"
      placeholder="Last Name" required /> -->

    <!-- <label for="customerEmail">Email</label>
    <input formControlName="customerEmail" type="email" class="form-control" id="customerEmail" name="customerEmail"
      placeholder="email@example.com" required />

    <label for="customerPhone">Phone Number</label>
    <input formControlName="customerPhone" type="text" class="form-control" id="customerPhone" name="customerPhone"
      placeholder="Phone Number" required /> -->

    <label for="incidentDescription">Description</label>
    <textarea
      formControlName="incidentDescription"
      class="form-control"
      id="incidentDescription"
      name="incidentDescription"
      rows="3"
      required
    ></textarea>

    <div *ngIf="editMode; else elseBlock">
      <label for="incidentNarrative">Incident Narrative</label>
      <textarea
        formControlName="incidentNarrative"
        class="form-control"
        id="incidentNarrative"
        name="incidentNarrative"
        rows="4"
      >
      </textarea>
    </div>

    <ng-template #elseBlock>
      <label for="incidentNarrative">Incident Narrative</label>
      <textarea
        formControlName="incidentNarrative"
        class="form-control"
        id="incidentNarrative"
        name="incidentNarrative"
        rows="4"
        readonly
      >
      </textarea>
    </ng-template>

    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="!incidentForm.valid"
    >
      Create Incident
    </button>
    <br />
    <br />
    <button type="button" (click)="this.initForm()">Reset</button>

    <button type="button" routerLink="/">Cancel</button>
  </div>
</form>
